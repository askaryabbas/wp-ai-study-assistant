!function(){"use strict";!function(){function t(t,e){return(e||document).querySelector(t)}function e(t,e){t.setAttribute("aria-busy",e?"true":"false")}function a(t){const e=t.currentTarget.closest(".wpai-card")||t.currentTarget;e.classList.toggle("is-flipped"),e.setAttribute("aria-pressed",e.classList.contains("is-flipped")?"true":"false")}function n(t,e,a,n){const r=t.querySelector(".wpai-button__label");t.dataset.state=e,"busy"===e?(t.classList.add("is-busy"),r.textContent=n||"Generatingâ€¦"):(t.classList.remove("is-busy"),r.textContent=a||"Generate")}function r(){const r=t(".wpai-form");if(!r)return;const i=t("#wpai-text",r),s=t(".wpai-grid"),c=t(".wpai-button",r);if(!i||!s||!c)return;const o=t(".wpai-status",r);r.addEventListener("submit",async t=>{t.preventDefault();const r=i.value.trim();if(!r)return void i.focus();const d=parseInt(s.getAttribute("data-max")||"5",10);n(c,"busy",WPAI_PUBLIC?.i18n?.generate,WPAI_PUBLIC?.i18n?.generating),e(s,!0),o.textContent="";try{const t=WPAI_PUBLIC?.ns||"askary-ai/v1",e=WPAI_PUBLIC?.root||"",n=await fetch(`${e}${t}/flashcards`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":WPAI_PUBLIC?.nonce||""},body:JSON.stringify({text:r})}),i=await n.json();if(!n.ok||!i?.ok||!Array.isArray(i.cards))throw new Error(i?.error||"Provider error");!function(t,e,n){t.innerHTML="",(Array.isArray(e)?e.slice(0,n):[]).forEach((e,n)=>{const r=document.createElement("button");r.type="button",r.className="wpai-card",r.setAttribute("aria-pressed","false"),r.setAttribute("aria-label",`Flip flashcard ${n+1}`),r.addEventListener("click",a);const i=document.createElement("div");i.className="wpai-card__inner";const s=document.createElement("div");s.className="wpai-card__face wpai-card__face--front";const c=document.createElement("span");c.className="wpai-chip",c.textContent="Q";const o=document.createElement("div");o.className="wpai-card__text",o.textContent=e.q||"";const d=document.createElement("div");d.className="wpai-card__face wpai-card__face--back";const l=document.createElement("span");l.className="wpai-chip",l.textContent="A";const p=document.createElement("div");p.className="wpai-card__text",p.textContent=e.a||"",s.appendChild(c),s.appendChild(o),d.appendChild(l),d.appendChild(p),i.appendChild(s),i.appendChild(d),r.appendChild(i),t.appendChild(r)})}(s,i.cards,d),o.textContent=""}catch(t){o.textContent=WPAI_PUBLIC?.i18n?.error||"Something went wrong. Please try again.",console.error(t)}finally{n(c,"idle",WPAI_PUBLIC?.i18n?.generate),e(s,!1)}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r()}()}();