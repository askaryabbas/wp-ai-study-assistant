!function(){"use strict";!function(){function t(t,e){return(e||document).querySelector(t)}function e(t,e){t.setAttribute("aria-busy",e?"true":"false")}function n(t){const e=t.currentTarget.closest(".wpai-card")||t.currentTarget;e.classList.toggle("is-flipped"),e.setAttribute("aria-pressed",e.classList.contains("is-flipped")?"true":"false")}function a(t,e,n,a){const i=t.querySelector(".wpai-button__label");t.dataset.state=e,"busy"===e?(t.classList.add("is-busy"),i.textContent=a||"Generatingâ€¦"):(t.classList.remove("is-busy"),i.textContent=n||"Generate")}function i(){const i=t(".wpai-form"),r=t("#wpai-text",i),s=t(".wpai-grid"),c=t(".wpai-button",i),o=t(".wpai-status",i);i&&r&&s&&c&&i.addEventListener("submit",async function(t){t.preventDefault();const i=r.value.trim();if(!i)return void r.focus();const d=parseInt(s.getAttribute("data-max")||"5",10);a(c,"busy",WPAI_PUBLIC&&WPAI_PUBLIC.i18n&&WPAI_PUBLIC.i18n.generate,WPAI_PUBLIC&&WPAI_PUBLIC.i18n&&WPAI_PUBLIC.i18n.generating),e(s,!0),o.textContent="";try{const t=await fetch((WPAI_PUBLIC.root||"")+(WPAI_PUBLIC.ns?WPAI_PUBLIC.ns:"askary-ai/v1")+"/flashcards",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":WPAI_PUBLIC.nonce||""},body:JSON.stringify({text:i})}),e=await t.json();if(!(t.ok&&e&&e.ok&&Array.isArray(e.cards)))throw new Error(e&&e.error||"Provider error");!function(t,e,a){t.innerHTML="",(Array.isArray(e)?e.slice(0,a):[]).forEach((e,a)=>{const i=document.createElement("button");i.type="button",i.className="wpai-card",i.setAttribute("aria-pressed","false"),i.setAttribute("aria-label",`Flip flashcard ${a+1}`),i.addEventListener("click",n);const r=document.createElement("div");r.className="wpai-card__inner";const s=document.createElement("div");s.className="wpai-card__face wpai-card__face--front";const c=document.createElement("span");c.className="wpai-chip",c.textContent="Q";const o=document.createElement("div");o.className="wpai-card__text",o.textContent=e.q||"";const d=document.createElement("div");d.className="wpai-card__face wpai-card__face--back";const l=document.createElement("span");l.className="wpai-chip",l.textContent="A";const p=document.createElement("div");p.className="wpai-card__text",p.textContent=e.a||"",s.appendChild(c),s.appendChild(o),d.appendChild(l),d.appendChild(p),r.appendChild(s),r.appendChild(d),i.appendChild(r),t.appendChild(i)})}(s,e.cards,d),o.textContent=""}catch(t){o.textContent=WPAI_PUBLIC&&WPAI_PUBLIC.i18n&&WPAI_PUBLIC.i18n.error||"Something went wrong. Please try again.",console.error(t)}finally{a(c,"idle",WPAI_PUBLIC&&WPAI_PUBLIC.i18n&&WPAI_PUBLIC.i18n.generate),e(s,!1)}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i()}()}();