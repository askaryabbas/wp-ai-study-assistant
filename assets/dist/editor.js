!function(){"use strict";!function(e){const{__:t}=e.i18n,{registerBlockType:a}=e.blocks,{TextareaControl:s,Button:r,Spinner:n,Notice:i}=e.components,{Fragment:c,useState:o}=e.element,{registerPlugin:l}=e.plugins,d=e.editor&&e.editor.PluginDocumentSettingPanel||e.editPost&&e.editPost.PluginDocumentSettingPanel,{select:m,dispatch:p}=e.data,u=e.apiFetch,y=window.WPAI_CONFIG&&window.WPAI_CONFIG.namespace||"askary-ai/v1";a("askary/qa-accordion-ai",{title:t("AI Q&A Accordion","wp-ai-study-assistant"),description:t("Generate 5 question/answer pairs from pasted text and render them as an accordion.","wp-ai-study-assistant"),category:"widgets",icon:"list-view",attributes:{sourceText:{type:"string",default:""},cards:{type:"array",default:[]}},edit:a=>{const{attributes:l,setAttributes:d}=a,[m,p]=o(!1),[g,w]=o("");return e.element.createElement(c,{},e.element.createElement(s,{label:t("Paste source text","wp-ai-study-assistant"),help:t("We will generate up to 5 concise Q/A pairs.","wp-ai-study-assistant"),value:l.sourceText,onChange:e=>d({sourceText:e}),__nextHasNoMarginBottom:!0}),e.element.createElement(r,{variant:"primary",onClick:async()=>{p(!0),w("");try{const e=await u({path:`/${y}/flashcards`,method:"POST",data:{text:l.sourceText}});e&&e.ok&&Array.isArray(e.cards)?d({cards:e.cards}):w(e&&e.error?e.error:t("Unexpected response","wp-ai-study-assistant"))}catch(e){w(e&&e.message?e.message:String(e))}finally{p(!1)}},disabled:m||!l.sourceText.trim(),style:{marginTop:"8px"}},t(m?"Generating…":"Generate Q&A","wp-ai-study-assistant")),m&&e.element.createElement(n,{}),g&&e.element.createElement(i,{status:"error",isDismissible:!0},g),Array.isArray(l.cards)&&l.cards.length>0&&e.element.createElement("div",{style:{marginTop:"1rem"}},l.cards.map((a,s)=>e.element.createElement("details",{key:s,style:{border:"1px solid #ddd",borderRadius:"6px",padding:"8px",marginBottom:"8px"}},e.element.createElement("summary",{},a.q?String(a.q):t("Untitled question","wp-ai-study-assistant")),e.element.createElement("div",{},a.a?String(a.a):"")))))},save:t=>{const{attributes:a}=t;return e.element.createElement("div",{className:"wp-block-askary-qa-accordion"},Array.isArray(a.cards)?a.cards.map((t,a)=>e.element.createElement("details",{key:a},e.element.createElement("summary",{},t.q||""),e.element.createElement("p",{},t.a||""))):null)}});l("wpai-meta-plugin",{render:()=>{const[a,s]=o(!1),[n,c]=o(""),[l,g]=o(!1);return e.element.createElement(d,{name:"wpai-meta-panel",title:t("AI Meta Description","wp-ai-study-assistant")},e.element.createElement("p",{},t("Generate a concise meta description (<=155 chars) and insert into Excerpt.","wp-ai-study-assistant")),e.element.createElement(r,{variant:"secondary",onClick:async()=>{s(!0),c(""),g(!1);try{const e=m("core/editor").getEditedPostAttribute("title")||"",a=m("core/editor").getEditedPostContent()||"",s=await u({path:`/${y}/meta`,method:"POST",data:{title:e,content:a}});s&&s.ok&&s.meta?(p("core/editor").editPost({excerpt:s.meta}),g(!0)):c(s&&s.error?s.error:t("Unexpected response","wp-ai-study-assistant"))}catch(e){c(e&&e.message?e.message:String(e))}finally{s(!1)}},disabled:a},t(a?"Generating…":"Generate","wp-ai-study-assistant")),l&&e.element.createElement(i,{status:"success",isDismissible:!0},t("Inserted into Excerpt.","wp-ai-study-assistant")),n&&e.element.createElement(i,{status:"error",isDismissible:!0},n))}})}(window.wp)}();